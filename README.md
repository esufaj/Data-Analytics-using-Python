EECS4415 Big Data Systems Summer 2021 Assignment 1

(10%): Data Analytics using PythonDue Date: 11:59 pmon Friday, May 21, 2021 Objective In  this assignment,  you  will write python programs/scriptsfor  performing  basic  analytics  on a  large dataset. The dataset  is  a  subset  of Yelp1's  businesses,  reviews,  and  user  data.  It  was  originally  put together  for the Yelp Dataset  Challenge  which  is  a  chance  for  students to  conduct  research or  analysis on  Yelp's  data. The dataset  contains  seven  CSV  files  including information  about  businesses  across  11 metropolitan areas in four countriesand can be accessed here(registration to Kaggle is required):Yelp dataset:https://www.kaggle.com/yelp-dataset/yelp-dataset/version/6orYelp dataset(local copy): https://www.eecs.yorku.ca/course_archive/2020-21/S/4415/yelp-data.zipThe  first  program (dstats.py)performs  descriptive  analytics ofthe  dataset.  The  second(dist-stats.py)computes  useful  frequency  distributions.  The third (yelp-network.py) constructs  a social network of Yelp friends. The fourth(graph-stats.py)performs basic network analytics.Important Notes: •You must use the submitcommand to electronically submit your solution by the due date. •Your programs should be tested on the docker image that we provided before being submitted.

A. Descriptive Statistics (30%, 5% each)
Write  a  python  program (dstats.py)  that  given  a  collection of businessesin  a  filefilename.csvand a name of a city citycomputesand prints out (in the STDOUT) the following statistics:•numOfBus: the number of businessesin the city•avgStars: the average number of stars of a business in the city•numOfRestaurants: the number of restaurantsin the city•avgStarsRestaurants: the average number of stars of restaurants in the city•avgNumOfReviews: the average number of reviews for all businesses in the city•avgNumOfReviewsBus: the average number of reviews for restaurants in the cityThe  collection  of  businesses  is  provided in  a  file  that  follows  the  same  format  as  the  original file provided by Kaggle(yelp_business.csv). The contents of the file we use for testing might vary.Running the script:Your script should be run as follows:%python3 dstats.py filename.csv cityFor example:% python3 dstats.py yelp_business.csvTorontoHint:Note  thatthe filename.csvand  the cityneed  to  be passed  to  the  program  as  command  line arguments. The argparsemodule makes it easy to write user-friendly command-line interfaces.

B. Distribution Statistics (30%, 10% each)Write   a   python   program   (dist-stats.py)   that   given   a   collection   of   businesses   in   afile filename.csvand a name of a city citycomputesand prints out (in the STDOUT) the following:•restaurantCategoryDist: a frequency distribution of the number of restaurants  in each categoryof  restaurants(e.g.,  Chinese,  Japanese,  Korean,  Greek,  etc.)in  a  descending  order  of popularity (from the most popular category to the least popular). The output should be one line per pair of values as follows: category:#restaurantsfor example:Korean:120Italian:110... •restaurantReviewDist: a frequency distribution  of the  number  of reviews submitted  for each category of restaurants (e.g., Chinese, Japanese, Korean, Greek, etc.) in a descending order (from  the  most  reviewed  category  to  the  least  reviewed),  along  with  the  average  number  of stars received per category. The output should be one line per triplet as follows: category:#reviews:avg_starsfor example:Korean:580:4.5Italian:110:3.8...•create a  bar  chart  that  shows  the top-10of restaurantCategoryDistfound earlier, where the x-axisrepresentsthe restaurant  category andthe y-axisrepresentsits  frequency (#restaurants).The  collection  of  businesses  is  provided in  a  file  that  follows  the  same  format  as  the  original  file provided by Kaggle (yelp_business.csv). The contents of the file we use for testing might vary.Running the script:Your script should be run as follows:% python3 dist-stats.py filename.csv cityFor example:% python3 dist-stats.py yelp_business.csvTorontoHint:Use  the matplotlib.pyplotmodule  to  create  the  plot.Follow  the  example  at  pythonspot2about using matplotlibto create a barchart:https://pythonspot.com/en/matplotlib-bar-chart/2https://pythonspot.com

C. Creating the Yelp Social Network(20%)Write   a   python   program   (yelp-network.py)   that   given   a   collection   of   users   in   a   file filename.csvcreates  a  file yelp-network.txtthat  represents  the  social  network  of  Yelp friends. The social network will be represented as a graph G(V,E), where Vis a set of vertices/nodes representing  the  Yelpusers  and Eis  a  set  of  links/edges  representing  friendships  between  Yelp  users. The  graph/network  should  be  represented  in  a  file using  the edge  list  format. An  edge  list  is  a  list  that represents all the edges in a graph. Each edge is represented as a pair of nodesoccupying a new line in the  file.  For  example,  a  small fully  connected triangle-like  graph  between  nodes a1, a2, a3would  be represented in the yelp-network.txtfile as:a1 a2a2 a3a3 a1Note  that  the  order  of  the  lines  does  not matter,and  edges  are  bidirectional(so either “a1 a2”or“a2a1” should be listed but not both).The collection of users and their friends is provided in a file that follows the same format as the original file provided by Kaggle (yelp_user.csv). The contents of the file we use for testing might vary.Running the script:Your scripts should be run as follows:% python3 yelp-network.py yelp_user.csv

D. Computing Network Statistics (20%)Write a python program (graph-stats.py) that given as input a file that represents a network as an edge list,computesand prints out (in the STDOUT) the following:•the number of nodes (|N|) and edges (|E|) of the network.The output should be as follows:#nodes:|N|#edges:|E|•nodeDegreeDist: a  frequency  distribution  of  the  node  degrees  of  the  network,  in  a descending order of frequency (from the highest to the lowest frequency). The degree of a node is  the  number  of  edges  that  are  incident  to  the node  (i.e.,  #neighbors).  The  output  should  be one line per pair of values as follows: nodeID:nodeDegreefor example:JJ-aSuM4pCFPdkfoZ34q0Q:14pzpbr9mlagHhDRdin8DvPQ:12...•avgNodeDegree: The average nodedegree of the graph.The output should be as follows:avgNodeDegree:XThe network is provided in a file that represents  a network  as an edge  list. The contents  of the file  we use for testing might vary.Running the script:Your script should be run as follows:% python3 graph-stats.pyyelp-network.txt

